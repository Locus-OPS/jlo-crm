<div class="container-fluid">
  <br />
  <div align="end">
    <button *ngIf="CAN_WRITE() && !created && (dataSource == null || dataSource.length == 0)" mat-raised-button type="button" class="btn btn-fill btn-primary" type="button"
      (click)="create(target)">{{ 'button.create' | translate }}</button>
      <button mat-raised-button type="button" class="btn btn-fill btn-default" *ngIf="CAN_WRITE() && created && (dataSource == null || dataSource.length == 0)"
        (click)="cancel()">{{ 'button.cancel' | translate }}</button>
  </div>
  <div class="material-datatables">
    <table mat-table [dataSource]="dataSource" class="mat-elevation-z8 table-responsive"
              (matSortChange)="tableControl.onSort($event)" matSort matSortActive="redeemMethodTypeName" matSortDirection="asc"
                matSortDisableClear>
      <ng-container matColumnDef="action">
        <th mat-header-cell *matHeaderCellDef>Action</th>
        <td mat-cell *matCellDef="let element">
          <button *ngIf="CAN_WRITE()" class="btn btn-danger btn-round btn-fab mat-raised-button" (click)="onDelete(element); $event.stopPropagation();">
            <span class="mat-button-wrapper">
              <i class="material-icons">remove</i>
            </span>
          </button>
        </td>
      </ng-container>
      <ng-container matColumnDef="redeemMethodTypeName">
        <th mat-header-cell *matHeaderCellDef mat-sort-header sticky> {{ 'reward.redeemMethod' | translate }} </th>
        <td mat-cell *matCellDef="let element"> {{element.redeemMethodTypeName}} </td>
      </ng-container>
      <ng-container matColumnDef="point">
        <th mat-header-cell *matHeaderCellDef> {{ 'reward.point' | translate }} </th>
        <td mat-cell *matCellDef="let element"> {{element.point}} </td>
      </ng-container>
      <ng-container matColumnDef="cash">
        <th mat-header-cell *matHeaderCellDef> {{ 'reward.cash' | translate }} </th>
        <td mat-cell *matCellDef="let element"> {{element.cash}} </td>
      </ng-container>
      <ng-container matColumnDef="createdDate">
        <th mat-header-cell *matHeaderCellDef> {{ 'common.createdDate' | translate }} </th>
        <td mat-cell *matCellDef="let element"> {{element.createdDate}} </td>
      </ng-container>
      <ng-container matColumnDef="createdBy">
        <th mat-header-cell *matHeaderCellDef> {{ 'common.createdBy' | translate }} </th>
        <td mat-cell *matCellDef="let element"> {{element.createdBy}} </td>
      </ng-container>
      <ng-container matColumnDef="updatedDate">
        <th mat-header-cell *matHeaderCellDef> {{ 'common.updatedDate' | translate }} </th>
        <td mat-cell *matCellDef="let element"> {{element.updatedDate}} </td>
      </ng-container>
      <ng-container matColumnDef="updatedBy">
        <th mat-header-cell *matHeaderCellDef> {{ 'common.updatedBy' | translate }} </th>
        <td mat-cell *matCellDef="let element"> {{element.updatedBy}} </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;" (click)="onSelectRow(row)"
      [ngClass]="{ 'selected-row': selectedRow == row }"></tr>
    </table>
    <mat-paginator class="mat-paginator-sticky" (page)="tableControl.onPage($event)" [length]="tableControl.total" [pageSize]="tableControl.pageSize"
      [pageSizeOptions]="tableControl.pageSizeOptions" showFirstLastButtons>
    </mat-paginator>
  </div>
  <div class="card-body" *ngIf="selectedRow">
    <form #createFormDirective="ngForm" [formGroup]="createForm" (ngSubmit)="onSave($event)">
      <div class="row">
        <mat-form-field class="col-md-4">
          <mat-select [placeholder]="'reward.redeemMethod' | translate" formControlName="redeemMethodType"
            (valueChange)="redeemMethodChange($event)">
            <mat-option *ngFor="let item of redeemMethodTypeList" [value]="item.codeId">{{ item.codeName }}</mat-option>
          </mat-select>
          <mat-error *ngIf="createForm.controls['redeemMethodType'].hasError('required')">
            {{ 'error.required' | translate }}
          </mat-error>
        </mat-form-field>
        <mat-form-field class="col-md-4">
          <mat-label>{{ 'reward.point' | translate }}</mat-label>
          <input matInput type="number" formControlName="point" [readonly]="isPointReadonly" min="0" />
          <mat-error *ngIf="createForm.controls['point'].hasError('required')">
            {{ 'error.required' | translate }}
          </mat-error>
          <mat-error *ngIf="createForm.controls['point'].hasError('min')">
            {{ 'error.min' | translate }}
          </mat-error>
        </mat-form-field>
        <mat-form-field class="col-md-4">
          <mat-label>{{ 'reward.cash' | translate }}</mat-label>
          <input matInput type="number" formControlName="cash" [readonly]="isCashReadonly" min="0" />
          <mat-error *ngIf="createForm.controls['cash'].hasError('required')">
            {{ 'error.required' | translate }}
          </mat-error>
          <mat-error *ngIf="createForm.controls['cash'].hasError('min')">
            {{ 'error.min' | translate }}
          </mat-error>
        </mat-form-field>
      </div>
      <button *ngIf="CAN_WRITE()" mat-raised-button type="submit" class="btn btn-rose pull-right">{{ 'button.save' | translate }}</button>
      <div class="clearfix"></div>
    </form>
  </div>
  <div *ngIf="!selectedRow"><br><br><br><br><br></div>
  <div #target></div>
</div>
