<div mat-dialog-content class="dialog-content">
  <!-- Header -->
  <div class="dialog-header">
    <div class="header-icon">
      <mat-icon>email</mat-icon>
    </div>
    <h4 class="header-title">{{ titleModalEmail }}</h4>
    <button type="button" class="dialog-close" [mat-dialog-close]="true">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <!-- Form -->
  <div class="form-container">
    <form [formGroup]="sendEmailForm">
      <div class="form-row">
        <mat-form-field appearance="outline">
          <mat-label>{{ 'email.from' | translate }}</mat-label>
          <input matInput type="text" formControlName="fromEmail" />
        </mat-form-field>
      </div>

      <div class="form-row">
        <mat-form-field appearance="outline">
          <mat-label>{{ 'email.to' | translate }}</mat-label>
          <mat-chip-grid formControlName="toEmail" #chipList aria-label="toEmail">
            <mat-chip *ngFor="let value of toEmails" (removed)="remove(value)">
              {{ value.email }}
              <mat-icon matChipRemove>cancel</mat-icon>
            </mat-chip>
            <input
              [placeholder]="'email.to.placeholder' | translate"
              [matChipInputFor]="chipList"
              [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
              (matChipInputTokenEnd)="add($event)"
              maxlength="500"
            />
          </mat-chip-grid>
          <button type="button" matSuffix mat-button (click)="searchCustomer('TO')" class="file-icon">
            <mat-icon>contact_mail</mat-icon>
          </button>
          @if(sendEmailForm.controls['toEmail'].hasError('required')){
          <mat-error>{{ 'error.required' | translate }}</mat-error>
          }
        </mat-form-field>
      </div>

      <div class="form-row">
        <mat-form-field appearance="outline">
          <mat-label>{{ 'email.cc' | translate }}</mat-label>
          <mat-chip-grid formControlName="ccEmail" #ccChipList aria-label="ccEmail">
            <mat-chip *ngFor="let value of ccEmails" (removed)="removeCC(value)">
              {{ value.email }}
              <mat-icon matChipRemove>cancel</mat-icon>
            </mat-chip>
            <input
              [placeholder]="'email.to.placeholder' | translate"
              [matChipInputFor]="ccChipList"
              [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
              (matChipInputTokenEnd)="addCC($event)"
              maxlength="500"
            />
          </mat-chip-grid>
          <button type="button" matSuffix mat-button (click)="searchCustomer('CC')" class="file-icon">
            <mat-icon>contact_mail</mat-icon>
          </button>
        </mat-form-field>
      </div>

      <div class="form-row">
        <mat-form-field appearance="outline">
          <mat-label>{{ 'email.subject' | translate }}</mat-label>
          <input matInput type="text" formControlName="subjectEmail" required />
          @if(sendEmailForm.controls['subjectEmail'].hasError('required')){
          <mat-error>{{ 'error.required' | translate }}</mat-error>
          }
        </mat-form-field>
      </div>

      <div class="form-row">
        <mat-form-field appearance="outline">
          <mat-label>{{ 'document.file' | translate }}</mat-label>
          <input type="file" hidden #fileUpload (change)="selectFile($event)" />
          <input disabled formControlName="fileName" matInput type="text" readonly />
          <button type="button" matSuffix mat-button (click)="fileUpload.click()" class="file-icon">
            <mat-icon>attachment</mat-icon>
          </button>
        </mat-form-field>
      </div>

      <div class="form-row">
        <div class="editor-container">
          <quill-editor formControlName="bodyEmail" format="html" [modules]="modules"></quill-editor>
        </div>
      </div>
    </form>
  </div>

  <!-- Footer Actions -->
  <div class="dialog-footer">
    <button mat-button mat-dialog-close (click)="onCancel()" class="btn-cancel">
      {{ 'button.close' | translate }}
    </button>
    <button mat-raised-button (click)="onSendEmail()" class="btn-send">
      <mat-icon>send</mat-icon>
      {{ 'btn.email.send' | translate }}
    </button>
  </div>
</div>
