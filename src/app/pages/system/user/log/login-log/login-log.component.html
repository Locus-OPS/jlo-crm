<div class="login-log-content">
  <!-- Search Form -->
  <div class="search-section">
    <form [formGroup]="searchForm" (ngSubmit)="search()" novalidate>
      <div class="search-row">
        <mat-form-field appearance="outline">
          <mat-label>{{ 'loginLog.attemptDateFrom' | translate }}</mat-label>
          <input matInput [matDatepicker]="pickerFrom" (dateChange)="onAttemptDateFromChange($event)" formControlName="attemptDateFrom">
          <mat-datepicker-toggle matSuffix [for]="pickerFrom"></mat-datepicker-toggle>
          <mat-datepicker #pickerFrom></mat-datepicker>
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>{{ 'loginLog.attemptDateTo' | translate }}</mat-label>
          <input matInput [matDatepicker]="pickerTo" (dateChange)="onAttemptDateToChange($event)" formControlName="attemptDateTo">
          <mat-datepicker-toggle matSuffix [for]="pickerTo"></mat-datepicker-toggle>
          <mat-datepicker #pickerTo></mat-datepicker>
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>{{ 'loginLog.statusCode' | translate }}</mat-label>
          <input matInput type="text" formControlName="statusCode">
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>{{ 'loginLog.statusMessage' | translate }}</mat-label>
          <input matInput type="text" formControlName="statusMessage">
        </mat-form-field>
      </div>
      <div class="search-actions">
        <button mat-raised-button type="submit" class="btn-search">
          <mat-icon>search</mat-icon>
          {{ 'button.search' | translate }}
        </button>
        <button mat-raised-button type="reset" class="btn-clear">
          {{ 'button.clear' | translate }}
        </button>
      </div>
    </form>
  </div>

  <!-- Table -->
  <div class="table-section">
    <div class="table-container">
      <table mat-table [dataSource]="dataSource" (matSortChange)="tableControl.onSort($event)" matSort
        matSortActive="attemptDate" matSortDirection="desc" matSortDisableClear>
        <ng-container matColumnDef="userId">
          <th mat-header-cell *matHeaderCellDef>{{ 'loginLog.userId' | translate }}</th>
          <td mat-cell *matCellDef="let element">{{ element.userId }}</td>
        </ng-container>
        <ng-container matColumnDef="attemptDate">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>{{ 'loginLog.attemptDate' | translate }}</th>
          <td mat-cell *matCellDef="let element">{{ element.attemptDate }}</td>
        </ng-container>
        <ng-container matColumnDef="type">
          <th mat-header-cell *matHeaderCellDef>{{ 'loginLog.type' | translate }}</th>
          <td mat-cell *matCellDef="let element">
            <span class="type-badge" [ngClass]="element.type?.toLowerCase()">{{ element.type }}</span>
          </td>
        </ng-container>
        <ng-container matColumnDef="ipAddress">
          <th mat-header-cell *matHeaderCellDef>{{ 'loginLog.ipAddress' | translate }}</th>
          <td mat-cell *matCellDef="let element">
            <code class="ip-address">{{ element.ipAddress }}</code>
          </td>
        </ng-container>
        <ng-container matColumnDef="statusCode">
          <th mat-header-cell *matHeaderCellDef>{{ 'loginLog.statusCode' | translate }}</th>
          <td mat-cell *matCellDef="let element">
            <span class="status-badge" [ngClass]="{'success': element.statusCode === '200', 'error': element.statusCode !== '200'}">
              {{ element.statusCode }}
            </span>
          </td>
        </ng-container>
        <ng-container matColumnDef="statusMessage">
          <th mat-header-cell *matHeaderCellDef>{{ 'loginLog.statusMessage' | translate }}</th>
          <td mat-cell *matCellDef="let element">{{ element.statusMessage }}</td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
      @if(tableControl.total === 0) {
        <div class="data-not-found">
          <mat-icon>search_off</mat-icon>
          <span>ไม่พบข้อมูล</span>
        </div>
      }
    </div>
    <mat-paginator (page)="tableControl.onPage($event)" [length]="tableControl.total"
      [pageSize]="tableControl.pageSize" [pageSizeOptions]="tableControl.pageSizeOptions" showFirstLastButtons>
    </mat-paginator>
  </div>
</div>
